 <!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Clappr M3U Player</title>
  <script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
  <script src="https://cdn.jsdelivr.net/clappr.level-selector/latest/level-selector.min.js"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      background: #000;
    }
    #player {
      width: 100%;
      max-width: 100%;
      aspect-ratio: 16 / 9;
      background: #000;
    }
  </style>
</head>
<body>
  <div id="player"></div>

  <script>
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    const url = getQueryParam('url');
    const id = getQueryParam('id');
    const playerElement = document.getElementById("player");

    function createPlayer(source) {
      new Clappr.Player({
        source: source,
        parentId: '#player',
        autoPlay: true,
        width: '100%',
        height: '100%',
        plugins: [LevelSelector],
        levelSelectorConfig: {
          title: 'Quality',
        },
        playback: {
          playInline: true
        }
      });
    }

    if (url) {
      createPlayer(url);
    } else if (id) {
      fetch("https://d75dqofg5kmfk.pages.dev/bpk-tv/music.json")
        .then(response => response.json())
        .then(data => {
          if (data[id] && data[id].file) {
            createPlayer(data[id].file);
          } else {
            playerElement.innerHTML = "<p style='color:white;text-align:center;padding-top:20px;'>Channel not found.</p>";
          }
        })
        .catch(err => {
          playerElement.innerHTML = "<p style='color:white;text-align:center;padding-top:20px;'>Failed to load channel list.</p>";
        });
    } else {
      playerElement.innerHTML = "<p style='color:white;text-align:center;padding-top:20px;'>No URL or ID specified.</p>";
    }
  </script>
</body>
</html>
